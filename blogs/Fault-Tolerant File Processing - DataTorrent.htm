<!DOCTYPE html>
<!-- saved from url=(0064)https://www.datatorrent.com/blog/fault-tolerant-file-processing/ -->
<html class="js wf-ptsans-n4-active wf-anticslab-n4-active wf-active ua-chrome ua-chrome-65 ua-chrome-65-0 ua-chrome-65-0-3325 ua-chrome-65-0-3325-181 ua-desktop ua-desktop-macintosh ua-mac_os_x ua-mac_os_x-10 ua-mac_os_x-10-13 ua-mac_os_x-10-13-3 ua-webkit ua-webkit-537 ua-webkit-537-36 js applicationcache geolocation history postmessage websockets localstorage sessionstorage websqldatabase webworkers hashchange audio canvas canvastext video webgl cssgradients multiplebgs opacity rgba inlinesvg hsla supports svgclippaths smil no-touchevents fontface generatedcontent textshadow indexeddb indexeddb-deletedatabase cssanimations backgroundsize borderimage borderradius boxshadow flexbox cssreflections csstransforms csstransforms3d csstransitions" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# og: http://ogp.me/ns#" data-useragent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36" style="overflow-y: auto;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/p.js" async=""></script><script type="text/javascript" async="" src="./Fault-Tolerant File Processing - DataTorrent_files/munchkin.js"></script><script type="text/javascript" async="" src="./Fault-Tolerant File Processing - DataTorrent_files/insight.min.js"></script><script type="text/javascript" id="async-buttons" src="./Fault-Tolerant File Processing - DataTorrent_files/async-buttons.js"></script>
    <!-- Google Tag Manager -->
    <script type="text/javascript" async="" src="./Fault-Tolerant File Processing - DataTorrent_files/analytics.js"></script><script src="./Fault-Tolerant File Processing - DataTorrent_files/webfont.js" type="text/javascript" async=""></script><script async="" src="./Fault-Tolerant File Processing - DataTorrent_files/gtm.js"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-TBBMZ7');</script>
    <!-- End Google Tag Manager -->

    <script type="text/javascript">
        (function() {
          var didInit = false;
          function initMunchkin() {
            if(didInit === false) {
              didInit = true;
              Munchkin.init('661-RYF-836');
            }
          }
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//munchkin.marketo.net/munchkin.js';
          s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
              initMunchkin();
            }
          };
          s.onload = initMunchkin;
          document.getElementsByTagName('head')[0].appendChild(s);
        })();
    </script><script type="text/javascript" async="" src="./Fault-Tolerant File Processing - DataTorrent_files/munchkin(1).js"></script>
    
    
    
    <link rel="shortcut icon" href="https://www.datatorrent.com/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://www.datatorrent.com/favicon.ico" type="image/x-icon">

    
    <!--[if lte IE 8]>
    <script type="text/javascript" src="https://www.datatorrent.com/wp-content/themes/Avada/assets/js/html5shiv.js"></script>
    <![endif]-->

    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fault-Tolerant File Processing - DataTorrent</title>
						<script>
							/* You can add more configuration options to webfontloader by previously defining the WebFontConfig with your options */
							if ( typeof WebFontConfig === "undefined" ) {
								WebFontConfig = new Object();
							}
							WebFontConfig['google'] = {families: ['Antic+Slab:400', 'PT+Sans:400']};

							(function() {
								var wf = document.createElement( 'script' );
								wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.5.3/webfont.js';
								wf.type = 'text/javascript';
								wf.async = 'true';
								var s = document.getElementsByTagName( 'script' )[0];
								s.parentNode.insertBefore( wf, s );
							})();
						</script>
						
<!-- This site is optimized with the Yoast SEO plugin v5.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<link rel="canonical" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Fault-Tolerant File Processing - DataTorrent">
<meta property="og:description" content="A majority of the big data setups still use files and streaming applications and platforms are a new concept.">
<meta property="og:url" content="https://www.datatorrent.com/blog/fault-tolerant-file-processing/">
<meta property="og:site_name" content="DataTorrent">
<meta property="article:section" content="Technical">
<meta property="article:published_time" content="2016-05-17T11:37:49+00:00">
<meta property="article:modified_time" content="2017-10-09T13:38:22+00:00">
<meta property="og:updated_time" content="2017-10-09T13:38:22+00:00">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/Chandni_blog_diagram1.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/Chandni_blog_diagram1.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p1.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p1.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram2.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram2.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p2.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p2.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/06/chandni_blog_diagram3_1.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/06/chandni_blog_diagram3_1.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p3.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_p3.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram4.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram4.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram5.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram5.png">
<meta property="og:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram6.png">
<meta property="og:image:secure_url" content="https://www.datatorrent.com/wp-content/uploads/2016/05/chandni_blog_diagram6.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="A majority of the big data setups still use files and streaming applications and platforms are a new concept.">
<meta name="twitter:title" content="Fault-Tolerant File Processing - DataTorrent">
<meta name="twitter:image" content="https://www.datatorrent.com/wp-content/uploads/2016/05/Chandni_blog_diagram1.png">
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/www.datatorrent.com\/","name":"DataTorrent","potentialAction":{"@type":"SearchAction","target":"https:\/\/www.datatorrent.com\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<script type="application/ld+json">{"@context":"http:\/\/schema.org","@type":"Organization","url":"https:\/\/www.datatorrent.com\/blog\/fault-tolerant-file-processing\/","sameAs":[],"@id":"#organization","name":"DataTorrent","logo":"https:\/\/www.datatorrent.com\/wp-content\/uploads\/2016\/11\/DataTorrentLogoWP.png"}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="DataTorrent » Feed" href="https://www.datatorrent.com/feed/">
<link rel="alternate" type="application/rss+xml" title="DataTorrent » Comments Feed" href="https://www.datatorrent.com/comments/feed/">
			<!-- For iPad Retina display -->
			<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/">
		<link rel="alternate" type="application/rss+xml" title="DataTorrent » Fault-Tolerant File Processing Comments Feed" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/feed/">

		<meta property="og:title" content="Fault-Tolerant File Processing">
		<meta property="og:type" content="article">
		<meta property="og:url" content="https://www.datatorrent.com/blog/fault-tolerant-file-processing/">
		<meta property="og:site_name" content="DataTorrent">
		<meta property="og:description" content="A majority of the big data setups still use files and streaming applications and platforms are a new concept. For a streaming platform to be widely usable, it should be able to handle files and process them in a performant way. Apache Apex provides out of the box support for handling files. This">

				<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.datatorrent.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Fault-Tolerant File Processing - DataTorrent_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="avada-stylesheet-css" href="./Fault-Tolerant File Processing - DataTorrent_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-dynamic-css-css" href="./Fault-Tolerant File Processing - DataTorrent_files/avada-4092.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="./Fault-Tolerant File Processing - DataTorrent_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="stylesheet-css" href="./Fault-Tolerant File Processing - DataTorrent_files/styles(1).css" type="text/css" media="all">
<link rel="stylesheet" id="dt-shortcodes-css" href="./Fault-Tolerant File Processing - DataTorrent_files/shortcodes.css" type="text/css" media="all">
<link rel="stylesheet" id="dt-avadashortcodes-css" href="./Fault-Tolerant File Processing - DataTorrent_files/avada-shortcodes.css" type="text/css" media="all">
<link rel="stylesheet" id="dt-avadastyles-css" href="./Fault-Tolerant File Processing - DataTorrent_files/avada-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-parent-stylesheet-css" href="./Fault-Tolerant File Processing - DataTorrent_files/style(1).css" type="text/css" media="all">
<link rel="stylesheet" id="fontawesome-css" href="./Fault-Tolerant File Processing - DataTorrent_files/font-awesome.css" type="text/css" media="all">
<!--[if lte IE 9]>
<link rel='stylesheet' id='avada-IE-fontawesome-css'  href='https://www.datatorrent.com/wp-content/themes/Avada/assets/fonts/fontawesome/font-awesome.css?ver=1.0.0' type='text/css' media='all' />
<![endif]-->
<!--[if lte IE 8]>
<link rel='stylesheet' id='avada-IE8-css'  href='https://www.datatorrent.com/wp-content/themes/Avada/assets/css/ie8.css?ver=1.0.0' type='text/css' media='all' />
<![endif]-->
<!--[if IE]>
<link rel='stylesheet' id='avada-IE-css'  href='https://www.datatorrent.com/wp-content/themes/Avada/assets/css/ie.css?ver=1.0.0' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="avada-iLightbox-css" href="./Fault-Tolerant File Processing - DataTorrent_files/ilightbox.css" type="text/css" media="all">
<link rel="stylesheet" id="avada-animations-css" href="./Fault-Tolerant File Processing - DataTorrent_files/animations.css" type="text/css" media="all">
<link rel="stylesheet" id="A2A_SHARE_SAVE-css" href="./Fault-Tolerant File Processing - DataTorrent_files/addtoany.min.css" type="text/css" media="all">
<link rel="stylesheet" href="./Fault-Tolerant File Processing - DataTorrent_files/css"><script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery-migrate.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/addtoany.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.matchHeight-min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/fastclick.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/foundation.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.dotdotdot.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.sticky.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/lightslider.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/breakpoints.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.background-video.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.smooth-scroll.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/swiper.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/main.js"></script>
<link rel="https://api.w.org/" href="https://www.datatorrent.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.datatorrent.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.datatorrent.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.9.2">
<link rel="shortlink" href="https://www.datatorrent.com/?p=4092">
<link rel="alternate" type="application/json+oembed" href="https://www.datatorrent.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.datatorrent.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;format=xml">

<script type="text/javascript">
var a2a_config=a2a_config||{};a2a_config.callbacks=a2a_config.callbacks||[];a2a_config.templates=a2a_config.templates||{};
</script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/page.js" async="async"></script>
<script type="text/javascript">
	jQuery(document).ready(function(){
		jQuery('img[usemap]').rwdImageMaps();
	});
</script>
<style type="text/css">
	img[usemap] { max-width: 100%; height: auto; }
</style>
<!--[if IE 9]> <script>var _fusionParallaxIE9 = true;</script> <![endif]-->
    
    <!--[if lte IE 8]>
    <script type="text/javascript">
        jQuery(document).ready(function () {
            var imgs, i, w;
            var imgs = document.getElementsByTagName('img');
            for (i = 0; i < imgs.length; i++) {
                w = imgs[i].getAttribute('width');
                imgs[i].removeAttribute('width');
                imgs[i].removeAttribute('height');
            }
        });
    </script>

    <script src="https://www.datatorrent.com/wp-content/themes/Avada/assets/js/excanvas.js"></script>

    <![endif]-->

    <!--[if lte IE 9]>
    <script type="text/javascript">
        jQuery(document).ready(function () {

            // Combine inline styles for body tag
            jQuery('body').each(function () {
                var combined_styles = '<style type="text/css">';

                jQuery(this).find('style').each(function () {
                    combined_styles += jQuery(this).html();
                    jQuery(this).remove();
                });

                combined_styles += '</style>';

                jQuery(this).prepend(combined_styles);
            });
        });
    </script>

    <![endif]-->

    <script type="text/javascript">
        var doc = document.documentElement;
        doc.setAttribute('data-useragent', navigator.userAgent);
    </script>

    
    <meta class="foundation-mq"><link rel="stylesheet" type="text/css" href="./Fault-Tolerant File Processing - DataTorrent_files/buttons-secure.css"><iframe id="stSegmentFrame" name="stSegmentFrame" frameborder="0" scrolling="no" width="0px" height="0px" sandbox="allow-scripts allow-same-origin" style="display:none;" src="./Fault-Tolerant File Processing - DataTorrent_files/saved_resource.html"></iframe><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link id="mktoForms2BaseStyle" rel="stylesheet" type="text/css" href="./Fault-Tolerant File Processing - DataTorrent_files/forms2.css"><link id="mktoForms2ThemeStyle" rel="stylesheet" type="text/css" href="./Fault-Tolerant File Processing - DataTorrent_files/forms2-theme-simple.css"></head>


<body class="post-template-default single single-post postid-4092 single-format-standard fusion-body no-tablet-sticky-header no-mobile-sticky-header no-mobile-slidingbar no-mobile-totop mobile-logo-pos-left layout-wide-mode has-sidebar menu-text-align-center mobile-menu-design-modern fusion-image-hovers fusion-show-pagination-text do-animate breakpoint-1024" style="">
<!-- Google Tag Manager (noscript) -->
<noscript>&lt;iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TBBMZ7"
                  height="0" width="0" style="display:none;visibility:hidden"&gt;&lt;/iframe&gt;</noscript>
<!-- End Google Tag Manager (noscript) -->





<!--
`````````````````````````````````````````````
`````````````````````````````````````````````
````````````````````````````````````````````` NAV -->
<nav class="nav clearfix">

    <!-- MAIN NAV -->
    <div class="nav__main-nav">
        <!-- MOBILE BAR -->
        <div class="nav__mobile-bar clearfix">
            <!-- SEARCH -->
            <div class="nav__mobile-search">
                <a data-open="nav__search" aria-controls="nav__search" id="ns5rnz-reveal" aria-haspopup="true" tabindex="0"><i class="fa fa-search" aria-hidden="true"></i></a>
            </div>

            <!-- LOGO -->
            <div class="nav__mobile-logo">
                <a href="https://www.datatorrent.com/"><img src="./Fault-Tolerant File Processing - DataTorrent_files/logo_datatorrent.png" width="100%" height="100%" class="nav__logo"></a>
            </div>

            <!-- HAMBURGER MENU -->
            <div class="title-bar" data-responsive-toggle="main-menu" data-hide-for="medium" style="display: none;">
                <button class="menu-icon" type="button" data-toggle=""></button>
            </div>
        </div>

        <!-- NAV MENU CONTAINER -->
        <div class="nav__menu-container">
            <!-- MAIN NAV -->
            <div class="top-bar" id="main-menu">
                <ul class="horizontal menu nav__menu dropdown" data-hover-delay="0" data-closing-time="0" data-responsive-menu="drilldown medium-dropdown" data-back-button="&lt;li class=&quot;js-drilldown-back&quot;&gt;&lt;a tabindex=&quot;0&quot;&gt;Main Menu&lt;/a&gt;&lt;/li&gt;" role="menubar" data-dropdown-menu="dr5h46-dropdown-menu">
                    <!-- PRODUCTS AND SERVICES -->
                    <li class="nav__menu-item is-dropdown-submenu-parent opens-right" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-label="Products">
                        <a href="https://www.datatorrent.com/products-services" tabindex="0">Products</a>
                        <ul class="vertical menu nav__submenu submenu is-dropdown-submenu first-sub" data-submenu="" aria-hidden="true" role="menu">
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                                <a href="https://www.datatorrent.com/products-services/benefits/" class="nav__menu-mega-link">6 Reasons Why DataTorrent</a>
                                <a href="https://www.datatorrent.com/products-services/datatorrent-rts/" class="nav__menu-mega-link">DataTorrent RTS</a>
                                <a href="https://www.datatorrent.com/appfactory/" class="nav__menu-mega-link">AppFactory</a>
                                <a href="https://www.datatorrent.com/products-services/architecture/" class="nav__menu-mega-link">Architecture</a>
                                <a href="https://www.datatorrent.com/products-services/apache-apex/" class="nav__menu-mega-link">Apache Apex</a>
                                <!--<a href="/products-services/deployment-modes/" class="nav__menu-mega-link">Deployment Modes</a>-->
                            </li>
                        </ul>
                    </li>
                    <!-- SOLUTIONS -->
                    <!--<li class="nav__menu-item">
                        <a href="/solutions">Solutions</a>
                        <ul class="vertical menu nav__submenu">
                            <li>
                                <a href="#" class="nav__submenu-link">Use Cases</a>
                                <ul class="vertical menu nav__thirdmenu">
                                    <li><a href="/solutions/use-case/complex-data-replication/" class="nav__submenu-link">Complex Data Replication</a></li>
                                    <li><a href="/solutions/use-case/data-ingestion/" class="nav__submenu-link">Data Ingestion</a></li>
                                    <li><a href="/solutions/use-case/data-preparation/" class="nav__submenu-link">Data Preparation</a></li>
                                    <li><a href="/solutions/use-case/dimensional-compute/" class="nav__submenu-link">Dimensional Compute</a></li>
                                    <li><a href="/solutions/use-case/oltp-data-streaming/" class="nav__submenu-link">OLTP Data Streaming</a></li>
                                    <li><a href="/solutions/use-case/streaming-with-five-9s-availability/" class="nav__submenu-link">Streaming with Five 9s Availability</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#" class="nav__submenu-link">Industry</a>
                                <ul class="vertical menu nav__thirdmenu">
                                    <li><a href="/solutions/industry-page/advertising-technology/" class="nav__submenu-link">Advertising Technology</a></li>
                                    <li><a href="/solutions/industry-page/energy-and-utilities/" class="nav__submenu-link">Energy and Utilities</a></li>
                                    <li><a href="/solutions/industry-page/financial-services/" class="nav__submenu-link">Financial Services</a></li>
                                    <li><a href="/solutions/industry-page/healthcare/" class="nav__submenu-link">Healthcare</a></li>
                                    <li><a href="/solutions/industry-page/internet-of-things-iot/" class="nav__submenu-link">Internet of Things (IoT)</a></li>
                                    <li><a href="/solutions/industry-page/oil-gas/" class="nav__submenu-link">Oil &amp; Gas</a></li>
                                    <li><a href="/solutions/industry-page/retail-ecommerce/" class="nav__submenu-link">Retail &amp; eCommerce</a></li>
                                    <li><a href="/solutions/industry-page/security-intelligence/" class="nav__submenu-link">Security &amp; Intelligence</a></li>
                                    <li><a href="/solutions/industry-page/telecommunications/" class="nav__submenu-link">Telecommunications</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>-->
                    
                    <!-- CUSTOMERS -->
                    <li class="nav__menu-item" role="menuitem">
                        <a href="https://www.datatorrent.com/customers/">Customers</a>
                    </li>
                    <!-- GET ENGAGED -->
                    <li class="nav__menu-item is-dropdown-submenu-parent opens-right" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-label="Get Engaged">
                        <a href="https://www.datatorrent.com/contact-us">Get Engaged</a>
                        <ul class="vertical menu nav__submenu submenu is-dropdown-submenu first-sub" data-submenu="" aria-hidden="true" role="menu">
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/jumpstart/" class="nav__submenu-link">JumpStart</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/contact-us/" class="nav__submenu-link">Contact Us</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/request-a-demo/" class="nav__submenu-link">Request a Demo</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/download/" class="nav__submenu-link">Download RTS</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="http://apex.apache.org/downloads.html" class="nav__submenu-link">Download Apex</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/support/" class="nav__submenu-link">Get Support</a></li>
                            <!--<li><a href="/products-services/start-up-accelerator/" class="nav__submenu-link">Startup Accelerator</a></li>-->
                            <!--<li><a href="/university-incubator/" class="nav__submenu-link">University Incubator</a></li>-->
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/company/partners/" class="nav__submenu-link">Become A Partner</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/products-services/professional-services/" class="nav__submenu-link">Professional Services</a></li>
                            <!--<li><a href="/university/" class="nav__submenu-link">Get Training</a></li>-->
                        </ul>
                    </li>

                     <!-- MORE -->
                    <li class="nav__menu-item is-dropdown-submenu-parent opens-right" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-label="More">
                        <a href="https://www.datatorrent.com/company/about-us/">More</a>
                        <ul class="vertical menu nav__submenu submenu is-dropdown-submenu first-sub" data-submenu="" aria-hidden="true" role="menu">
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/company/about-us/" class="nav__submenu-link">About Us</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/news/" class="nav__submenu-link">In the News</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/blog/" class="nav__submenu-link">Blogs</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/events/" class="nav__submenu-link">Events</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/resources/" class="nav__submenu-link">Resources</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/company/why-datatorrent/" class="nav__submenu-link">Why DataTorrent</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/growth/" class="nav__submenu-link" target="_blank">Momentum</a></li>
                            <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item"><a href="https://www.datatorrent.com/company/careers/" class="nav__submenu-link">Careers</a></li>
                            <!--<li><a href="/company/team/" class="nav__submenu-link">Team</a></li>-->
                        </ul>
                    </li>

                    <!-- SEARCH ICON -->
                    <li class="nav__menu-item" role="menuitem"><a data-open="nav__search" aria-controls="nav__search" id="ns5rnz-reveal" aria-haspopup="true" tabindex="0"><i class="fa fa-search" aria-hidden="true"></i></a></li>
                    <!-- MODAL -->
                    
                    <li role="menuitem"><a href="https://www.datatorrent.com/download/" class="btn btn--green nav__btn">Download Now</a></li>
                </ul>
            </div>
            <!-- /top bar -->
        </div>
        <!-- /menu container -->
    </div>
    <!-- /main nav -->
</nav>
<div class="sticky-header-target"></div>
<!--
`````````````````````````````````````````````
`````````````````````````````````````````````
````````````````````````````````````````````` END NAV -->



<!--
`````````````````````````````````````````````
`````````````````````````````````````````````
````````````````````````````````````````````` STICKY HEADER -->
<div style="position: relative;">
<div class="sticky-header clearfix" style="display: block;">
    <!-- left -->
    <div class="sticky-header__left">
        <a href="https://www.datatorrent.com/"><img src="./Fault-Tolerant File Processing - DataTorrent_files/logo_datatorrent.png" width="100%" height="100%" class="nav__logo"></a>
    </div>
    <!-- right -->
    <div class="sticky-header__right">
        <a href="https://www.datatorrent.com/download/" class="btn btn--green nav__btn">Download Now</a>
    </div>
</div>
</div>
<!--
`````````````````````````````````````````````
`````````````````````````````````````````````
````````````````````````````````````````````` /STICKY HEADER -->



<div class="fusion-row" style=""> <div id="" class="topper " style="background: url(&quot;/wp-content/uploads/2017/08/header-black.jpg&quot;) center center / cover no-repeat; position: relative; overflow: hidden;"> 
   <video class="jquery-background-video" muted="" loop="" poster="/wp-content/uploads/2017/08/header-black.jpg" style="min-width: auto; min-height: auto; width: 1200px; height: auto; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); transition-duration: 2000ms;">
     <source src="no" type="video/mp4"> 
   </video> 
   <div class="relative"> 
<!-- BANNER --> 
<div class="topper__banner topper__banner--xs"> 
    <!-- h1 --> 
    <h1 class="heading--1" style="color: #ffffff; font-size: !important;" data-fontsize="70" data-lineheight="84">The DataTorrent Blog</h1> 
    <!-- category --> 
</div> 
<!-- STICKY NAV --> 
<ul class="topper__underline-nav topper__underline-nav--6 clearfix green "> 
 <li><a href="https://www.datatorrent.com/documents/" class="topper__underline-nav-item">Documents</a></li> 
 <li><a href="https://www.datatorrent.com/videos/" class="topper__underline-nav-item">Videos</a></li> 
 <li><a href="https://www.datatorrent.com/webinars/" class="topper__underline-nav-item">Webinars</a></li> 
 <li><a href="https://www.datatorrent.com/events/" class="topper__underline-nav-item">Events</a></li> 
 <li><a href="https://www.datatorrent.com/blog/" class="topper__underline-nav-item">Blogs</a></li> 
 <li><a href="https://www.datatorrent.com/product-documentation/" class="topper__underline-nav-item">Product Docs</a></li> 
</ul> 
</div> 
<button class="jquery-background-video-pauseplay pause" style="left: auto; right: 15px; top: 15px; bottom: auto;"><span>Pause</span></button></div> 
<div class="clearfix dt-list-page">
    <div class="padding padding--tb-sm fusion-clearfix">

        <div id="content" style="float: left;">

                            <div class="single-navigation clearfix">
                    <a href="https://www.datatorrent.com/blog/the-next-generation-of-big-data-and-apache-apex/" rel="prev">Previous</a>                    <a href="https://www.datatorrent.com/blog/throughput-latency-and-yahoo/" rel="next">Next</a>                </div>
            
                            <div id="post-4092" class="post post-4092 type-post status-publish format-standard has-post-thumbnail hentry category-technical">
                                        
                                                                                                                                        <div class="fusion-flexslider flexslider post-slideshow fusion-post-slideshow">
                                    <ul class="slides">
                                                                                                                                                                                                                                                                <li class="flex-active-slide" style="width: 100%; float: left; margin-right: -100%; position: relative; opacity: 1; display: block; z-index: 2;">
                                                                                                    <a href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/" data-rel="iLightbox[gallery4092]" title="" data-title="" data-caption="" class="fusion-no-lightbox">
                                                        <span class="screen-reader-text">View Larger Image</span>
                                                                                                            </a>
                                                                                            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ul>
                                <ol class="flex-control-nav flex-control-paging"></ol><ul class="flex-direction-nav"><li><a class="flex-prev flex-disabled" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#" tabindex="-1"></a></li><li><a class="flex-next flex-disabled" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#" tabindex="-1"></a></li></ul></div>
                                                                                                        
                                            <h2 class="entry-title" data-fontsize="30" data-lineheight="36">Fault-Tolerant File Processing</h2>                                        <div class="post-content">
                        <p><span style="font-weight: 400;">A majority of the big data setups still use files and streaming applications and platforms are a new concept. For a streaming platform to be widely usable, it should be able to handle files and process them in a performant way. Apache Apex provides out of the box support for handling files. This comes in the form of various operators for reading and writing files in a scalable and fault-tolerant manner. </span><span style="font-weight: 400;">In this blog post, we will discuss some of the fault-tolerance mechanisms provided by Apache Apex for file operations. </span></p>
<h2 data-fontsize="20" data-lineheight="24"><span style="font-weight: 400;">Background</span></h2>
<p><span style="font-weight: 400;">To understand fault-tolerance in any Apex operator, the reader should be aware of the concept of streaming windows in Apex. Essentially, windows are finite segments in an unbounded dataset. At the input operators in the DAG, the Apex platform inserts markers (control tuples) into the stream which mark start and end of a window. Each window is assigned an ID called Window ID that traverses the entire DAG, which helps with checkpointing the state of the operators and recovery after failures. More information on windowing can be found </span><a href="https://www.datatorrent.com/blog/real-time-event-stream-processing-what-are-your-choices/"><span style="font-weight: 400;">here</span></a><span style="font-weight: 400;">. </span></p>
<p><span style="font-weight: 400;">The Apex platform provides fault-tolerance out of the box for any intermediate operator in the streaming application. However, input and output connectors that interact with external systems need more than platform support. For example, an input operator should be able to replay tuples of a window that it has already finished processing when it is restarted after a failure; similarly, an output operator may have to cleanup data written beyond the recovery window when it is restarted at that window after a failure. </span></p>
<h2 data-fontsize="20" data-lineheight="24"><span style="font-weight: 400;">Reading From Files</span></h2>
<p><span style="font-weight: 400;">For reading from files with fault-tolerance, Apex provides an operator called </span><a href="https://github.com/apache/incubator-apex-malhar/blob/master/library/src/main/java/com/datatorrent/lib/io/fs/AbstractFileInputOperator.java"><span style="font-weight: 400;">AbstractFileInputOperator</span></a><span style="font-weight: 400;">. This operator requires a directory, which it scans periodically, and finds new files to read and parse. The </span><a href="https://github.com/apache/incubator-apex-malhar/blob/master/library/src/main/java/org/apache/apex/malhar/lib/fs/LineByLineFileInputOperator.java"><span style="font-weight: 400;">LineByLineFileInputOperator</span></a><span style="font-weight: 400;">, which is an extension of the above abstract operator, reads lines from files and outputs them. </span></p>
<h2 data-fontsize="20" data-lineheight="24"><span style="font-weight: 400;">Fault-Tolerance Aspects</span></h2>
<p style="font-weight: 400;"><b>1. Never loses a record</b></p>
<p><span style="font-weight: 400;">Platform support of stateful checkpointing and automatic recovery helps to achieve this. The properties and the state of the operator are preserved by the checkpointing mechanism. &nbsp;The important property in this operator is the folder to scan and the state is: </span></p>
<ol>
<ol>
<ol>
<ol style="list-style-type: lower-alpha;">
<li style="font-weight: 400;"><span style="font-weight: 400;">Set of files processed.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Current file and the offset to which it has been read.</span></li>
</ol>
</ol>
</ol>
</ol>
<p><span style="font-weight: 400;">After a failure, the operator is restored using a checkpointed state. With this state, the operator avoids losing any data and at the same time restart processing from an earlier point in the stream that is reasonably close to where it had gone down. &nbsp;This is illustrated in the diagram below.</span></p>
<p><img class="alignnone size-medium wp-image-4108" src="./Fault-Tolerant File Processing - DataTorrent_files/Chandni_blog_diagram1.png" alt="Chandni_blog_diagram1"></p>
<p><span style="font-weight: 400;">This example assumes default checkpointing frequency of 60 streaming windows. The input operator is checkpointed after window 59 is completed. From window 60, it continues reading file 3 from offset 1000. The operator fails at window 89 (an arbitrary window before the next checkpoint) and is restored in another container with the checkpointed state after window 59. The operator will now resume its processing from the beginning of window 60. The saved state lets the operator know that it had processed file1, file2 and file3 till offset 1000 so it opens file3 and starts reading it from offset 1000. &nbsp;</span></p>
<p style="font-weight: 400;"><b>2. Idempotent processing</b></p>
<p><span style="font-weight: 400;">In Apex, idempotent processing means that a finished window will always have the same records and a record is associated with exactly one finished window.</span> <span style="font-weight: 400;">A finished window is a window for which this operator has completed the </span><i><span style="font-weight: 400;">endWindow()</span></i><span style="font-weight: 400;"> callback. In order to support idempotent processing, an input operator needs to be able to replay a finished window. To understand the importance of idempotency, let’s consider the below example application:</span></p>
<p><span style="font-weight: 400;"><img src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_p1.png" alt="chandni_blog_p1"></span></p>
<p><span style="font-weight: 400;">CountStoreOperator persists records to a database exactly once using JDBC. The operator relies on the idempotent processing of the upstream operator to ensure exactly-once semantics which is explained in detail </span><a href="https://www.datatorrent.com/blog/end-to-end-exactly-once-with-apache-apex/"><span style="font-weight: 400;">here</span></a><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">If the </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">operator cannot replay a window with exactly the same tuples as before, it can result in either data loss or duplicated output down the pipeline. This is explained by extending the example in </span><span style="font-weight: 400;">diagram1.</span></p>
<p><img src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_diagram2.png" alt="Chandni_blog_diagram2"><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">In the above example, the </span><i><span style="font-weight: 400;">lineInput</span></i><span style="font-weight: 400;"> operator emits lines 1001 and 1002 in window 60. These lines are persisted by the </span><i><span style="font-weight: 400;">countStore</span></i><span style="font-weight: 400;"> in the same window to the database. In addition to persisting lines, the store operator also saves the window Id 60 in an additional metadata table in the database as a window Id that it has processed completely (refer </span><a href="https://www.datatorrent.com/blog/end-to-end-exactly-once-with-apache-apex/"><span style="font-weight: 400;">End-to-end “Exactly Once” with Apache Apex</span></a><span style="font-weight: 400;">).</span></p>
<p><span style="font-weight: 400;">The </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">operator fails on window 61 and so both the operators are re-deployed in new containers. These are restored with the state at the end of window 59. When </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">starts processing window 60 after recovery, it emits line 1001, 1002 &amp; 1003 in window 60. The </span><i><span style="font-weight: 400;">countStore </span></i><span style="font-weight: 400;">compares the current window (window 60) to the one saved in the metadata table. If the current window is less than or equal to the stored window then it will ignore all the tuples of that window because any updates related to those tuples are already persisted. Therefore, line 1003 is lost. If window 60 replays with just line 1001 with window 61 containing 1002 and 1003, line 1002 would be duplicated.</span></p>
<p><span style="font-weight: 400;">Records are lost when a finished window contains more records on replay. Alternatively, records are duplicated when they migrate from a finished window to a later window on replay.</span></p>
<p><span style="font-weight: 400;">The Apex library provides a utility called </span><a href="https://github.com/apache/incubator-apex-malhar/blob/master/library/src/main/java/org/apache/apex/malhar/lib/wal/WindowDataManager.java"><span style="font-weight: 400;">WindowDataManager</span></a><span style="font-weight: 400;"> which helps input operators to replay a finished window. This utility persists incremental state for each finished window. An implementation (FSWindowDataManager) that persists incremental state on file system is also provided in the same class.</span></p>
<p><span style="font-weight: 400;">The AbstractFileInputOperator uses WindowDataManager to repeat a finished window after failure so the </span><i><span style="font-weight: 400;">lineInput</span></i><span style="font-weight: 400;"> operator will save incremental state information every application window, which is a list of objects of type </span><i><span style="font-weight: 400;">RecoveryEntry.</span></i><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_p2.png" alt="chandni_blog_p2.png"></p>
<p><span style="font-weight: 400;">Each recovery entry tells how much a file was read in the corresponding window. &nbsp;The diagram below illustrates how this information is used to replay a window.</span></p>
<p><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_diagram3_1.png" alt="chandni_blog_diagram3.png"></p>
<p><span style="font-weight: 400;">The </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">operator at the end of window 60 uses WindowDataManager to save incremental state which indicates that it read file 1 from offset 1000 to 1400 in that window. It fails on window 61 and recovers at window 60. &nbsp;WindowDataManager provides a list of windows for which incremental state was persisted. Since window 60 is among those, the recovery entry is fetched in the</span><i><span style="font-weight: 400;"> beginWindow()</span></i><span style="font-weight: 400;"> callback and only the portion of the file corresponding to the recovery entry is read.</span></p>
<h2 data-fontsize="20" data-lineheight="24"><span style="font-weight: 400;">Writing To Files</span></h2>
<p><span style="font-weight: 400;">For fault-tolerant writing to files, Apex provides </span><a href="https://github.com/apache/incubator-apex-malhar/blob/master/library/src/main/java/com/datatorrent/lib/io/fs/AbstractFileOutputOperator.java"><span style="font-weight: 400;">AbstractFileOutputOperator</span></a><span style="font-weight: 400;">. This operator is designed to persist incoming records to a single file or multiple files. Additional optional features that the operator provides are: </span></p>
<ol style="list-style-type: lower-alpha;">
<li style="font-weight: 400;"><span style="font-weight: 400;">Automatic rotation of files based on either file size or window count or both.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Compression and encryption of data before it is persisted in files.</span></li>
</ol>
<p><span style="font-weight: 400;">Below is a simple extension of AbstractFileOutputOperator that enables rotation by size as well as windows and persists all the records to a file called </span><i><span style="font-weight: 400;">outputFile</span></i><span style="font-weight: 400;">:</span></p>
<pre class="prettyprint"><code class="language-java hljs "><span style="font-weight: 400;">public</span> <span style="font-weight: 400;">class</span> <span style="font-weight: 400;">LineOutputOperator</span> <span style="font-weight: 400;">extends</span> <span style="font-weight: 400;">AbstractFileOutputOperator</span><span style="font-weight: 400;">&lt;</span><span style="font-weight: 400;">String</span><span style="font-weight: 400;">&gt;</span>
<span style="font-weight: 400;">{</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">private</span> <span style="font-weight: 400;">static</span> <span style="font-weight: 400;">String</span><span style="font-weight: 400;"> FILE_NAME </span><span style="font-weight: 400;">=</span> <span style="font-weight: 400;">"outputFile"</span><span style="font-weight: 400;">;</span>

<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">public</span> <span style="font-weight: 400;">LineOutputOperator</span><span style="font-weight: 400;">()</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">{</span>
<span style="font-weight: 400;">  &nbsp; &nbsp; &nbsp;setMaxLength</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">67108864</span><span style="font-weight: 400;">);</span><span style="font-weight: 400;">  &nbsp; &nbsp;</span><span style="font-weight: 400;">//64 megabytes</span>
<span style="font-weight: 400;">  &nbsp; &nbsp; &nbsp;setRotationWindows</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">7200</span><span style="font-weight: 400;">);</span> <span style="font-weight: 400;">//1 hour considering default values</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">}</span>

<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">@Override</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">protected</span> <span style="font-weight: 400;">String</span><span style="font-weight: 400;"> getFileName</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">String</span><span style="font-weight: 400;"> tuple</span><span style="font-weight: 400;">)</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">{</span>
<span style="font-weight: 400;">  &nbsp; &nbsp; &nbsp;</span><span style="font-weight: 400;">return</span><span style="font-weight: 400;"> FILE_NAME</span><span style="font-weight: 400;">;</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">}</span>

<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">@Override</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">protected</span> <span style="font-weight: 400;">byte</span><span style="font-weight: 400;">[]</span><span style="font-weight: 400;"> getBytesForTuple</span><span style="font-weight: 400;">(</span><span style="font-weight: 400;">String</span><span style="font-weight: 400;"> tuple</span><span style="font-weight: 400;">)</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">{</span>
<span style="font-weight: 400;">  &nbsp; &nbsp; &nbsp;</span><span style="font-weight: 400;">return</span><span style="font-weight: 400;"> tuple</span><span style="font-weight: 400;">.</span><span style="font-weight: 400;">getBytes</span><span style="font-weight: 400;">();</span>
<span style="font-weight: 400;">  &nbsp;</span><span style="font-weight: 400;">}</span>
<span style="font-weight: 400;">}</span></code></pre>
<p><span style="font-weight: 400;">AbstractFileOutputOperator can write to multiple files. The file to which a particular record is persisted can be derived from the tuple. However, the LineOutputOperator here writes everything to a single file. It extracts the bytes of the record from the tuple and writes it to the output stream. It should be noted that the stream is not flushed after every write; instead it is flushed in the </span><i><span style="font-weight: 400;">endWindow()</span></i><span style="font-weight: 400;"> callback.</span></p>
<h2 data-fontsize="20" data-lineheight="24"><span style="font-weight: 400;">Fault-Tolerance Aspects</span></h2>
<p><span style="font-weight: 400;">For this operator, fault- tolerance is defined as writing each record to a file exactly once, that is, a record is never lost or duplicated.</span></p>
<p><b>Writing exactly once</b></p>
<p><span style="font-weight: 400;">The operator, just like any other Apex operator, leverages the platform capabilities of stateful checkpointing and automatic recovery. However platform support is not sufficient to provide the exactly once guarantee. Let’s consider the following application to understand the problem.</span></p>
<p><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_p3.png" alt="chandni_blog_p3.png"></p>
<p><span style="font-weight: 400;">If </span><i><span style="font-weight: 400;">lineOutput</span></i><span style="font-weight: 400;"> operator doesn’t cleanup data written beyond the recovery window when it is redeployed after failure then there will be duplicate lines in the output file as depicted in the diagram below.</span><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_diagram4.png" alt="chandni_blog_diagram4.png"></p>
<p><span style="font-weight: 400;">In this example, </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">operator emits lines 1001 and 1002 which are flushed to the </span><i><span style="font-weight: 400;">outputFile</span></i><span style="font-weight: 400;"> by </span><i><span style="font-weight: 400;">lineOutput </span></i><span style="font-weight: 400;">operator in the </span><i><span style="font-weight: 400;">endWindow() </span></i><span style="font-weight: 400;">callback. However, </span><i><span style="font-weight: 400;">lineInput</span></i><span style="font-weight: 400;"> fails on window 61 and both the operators are re-deployed with the state checkpointed after window 59. After recovery, </span><i><span style="font-weight: 400;">lineInput </span></i><span style="font-weight: 400;">operator</span> <span style="font-weight: 400;">will replay the window 60. If the </span><i><span style="font-weight: 400;">lineOutput </span></i><span style="font-weight: 400;">operator doesn’t perform any cleanup after recovery, then it will end up writing lines 1001 and 1002 again to </span><i><span style="font-weight: 400;">outputFile</span></i><span style="font-weight: 400;">.</span></p>
<p><span style="font-weight: 400;">The base AbstractFileOutputOperator avoids writing duplicates by effectively truncating </span><i><span style="font-weight: 400;">outputFile</span></i><span style="font-weight: 400;"> to its size after window 59. Therefore, it keeps a state which comprises mainly of the size of each file that it has written to so far. &nbsp;This is depicted in the diagram below.</span></p>
<p><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_diagram5.png" alt="chandni_blog_diagram5.png"></p>
<p><span style="font-weight: 400;">Here, in the </span><i><span style="font-weight: 400;">setup()</span></i><span style="font-weight: 400;"> callback after redeployment, the </span><i><span style="font-weight: 400;">lineOutput</span></i><span style="font-weight: 400;"> operator truncates </span><i><span style="font-weight: 400;">outputFile</span></i><span style="font-weight: 400;"> to size 1000 which was saved in the checkpointed state. From window 60, it starts its normally processing of writing records to files.</span></p>
<p><span style="font-weight: 400;">An example application which reads records from kafka and writes them to a file exactly once is present </span><a href="https://github.com/tweise/apex-samples/blob/master/exactly-once/src/main/java/com/example/myapexapp/AtomicFileOutputApp.java"><span style="font-weight: 400;">here</span></a><span style="font-weight: 400;">.</span></p>
<p><b>Writing exactly once to HDFS</b></p>
<p><span style="font-weight: 400;">When writing to HDFS, the fault-tolerance/recovery process described above is more complicated due to the HDFS lease mechanism.</span></p>
<p><span style="font-weight: 400;">HDFS allows multiple readers but only a single writer. &nbsp;Before a client writes to a file, it has to obtain the lease for that file. This lease acts like a lock which prevents other clients from writing to that file. However, any failure may terminate the client. When a client is terminated, any lease it had acquired may still be active and may prevent other clients to write to the associated file.</span></p>
<p><span style="font-weight: 400;">Here the client is an instance of AbstractFileOutputOperator which acquires the lease of a file when it opens an output stream to that file. If this instance fails before it can close the stream to that file, then there will be a dangling lease of that file in the Name Node. The platform will restore the failed operator in another container. This new instance is the new client which will try to write to the same file but will fail with a lease exception.</span></p>
<p><span style="font-weight: 400;">The AbstractFileOutputOperator handles this by always writing to a temporary file and renaming the temporary file to the original file only when there is no possibility of writing to that file again. This process is called </span><b>finalization</b><span style="font-weight: 400;">. To request a file to be finalized, the extensions of this operator can invoke the method </span><i><span style="font-weight: 400;">requestFinalize(String fileName)</span></i><span style="font-weight: 400;">. This request can be made just after it is known that the file will not be open again. When rotation is enabled, a part file is requested for finalization as soon as it gets completed and the new part opens. The actual finalization happens in the </span><i><span style="font-weight: 400;">committed(long window)</span></i><span style="font-weight: 400;"> callback for the window in which the file was requested to finalize.</span></p>
<p><span style="font-weight: 400;">Writing to temporary files makes recovery cumbersome because a temporary file changes with failures. The temporary file name is derived by appending the system timestamp at its time of creation to the original file name. Therefore, in addition to the size of each file, the operator now also tracks temporary file name of each file. This is part of the operator’s state which it uses during recovery to copy the valid data from the existing temporary file to a new temporary file as shown in the diagram below.</span></p>
<p><img class=" aligncenter" src="./Fault-Tolerant File Processing - DataTorrent_files/chandni_blog_diagram6.png" alt="chandni_blog_diagram6.png"></p>
<p><span style="font-weight: 400;">In this example, the </span><i><span style="font-weight: 400;">lineOutput</span></i><span style="font-weight: 400;"> was writing to the temp file</span><i><span style="font-weight: 400;"> outputFile.0.1463040570</span></i><span style="font-weight: 400;"> before failure. After failure, it copies 1000 bytes from this temp file to </span><i><span style="font-weight: 400;">outputFile.0.1463065130.tmp</span></i><span style="font-weight: 400;">. In Window 199, the part 0 of the file gets completed so it is requested for finalization. The actual finalization is done only when window 199 is committed.</span></p>
<p><span style="font-weight: 400;">In conclusion, Apache Apex Malhar library provides a rich set of connectors that work with the Apex platform to be fault-tolerant and provide exactly once guarantees.</span></p>
                                            </div>

                    
                           

                        <div class="fusion-meta-info"><div class="fusion-meta-info-wrapper"><div class="blog-author-single">Chandni Singh&nbsp;|&nbsp;</div>
	
			<span class="vcard" style="display: none;">
			<span class="fn">
				<a href="https://www.datatorrent.com/blog/author/michelle/" title="Posts by michelle" rel="author">michelle</a>			</span>
		</span>
	
	

	
	
			<span class="updated" style="display:none;">
			2017-10-09T13:38:22+00:00		</span>
	
<span>May 17th, 2016</span><span class="fusion-inline-sep">|</span><a href="https://www.datatorrent.com/blog/category/technical/" rel="category tag">Technical</a><span class="fusion-inline-sep">|</span><span class="fusion-comments"><a href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#comments">1 Comment</a></span></div></div>                        			<div class="fusion-sharing-box fusion-single-sharing-box share-box">
				<h4 data-fontsize="13" data-lineheight="19">Share This Story, Choose Your Platform!</h4>
				<div class="fusion-social-networks"><div class="fusion-social-networks-wrapper"><a class="fusion-social-network-icon fusion-tooltip fusion-facebook fusion-icon-facebook" style="color:#bebdbd;" href="http://www.facebook.com/sharer.php?m2w&amp;s=100&amp;p[url]=https://www.datatorrent.com/blog/fault-tolerant-file-processing/&amp;p[images][0]=&amp;p[title]=Fault-Tolerant%20File%20Processing" target="_blank" data-placement="top" data-title="Facebook" data-toggle="tooltip" title="" data-original-title="Facebook"><span class="screen-reader-text">Facebook</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-twitter fusion-icon-twitter" style="color:#bebdbd;" href="https://twitter.com/share?text=Fault-Tolerant%20File%20Processing&amp;url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F" target="_blank" data-placement="top" data-title="Twitter" data-toggle="tooltip" title="" data-original-title="Twitter"><span class="screen-reader-text">Twitter</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-linkedin fusion-icon-linkedin" style="color:#bebdbd;" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.datatorrent.com/blog/fault-tolerant-file-processing/&amp;title=Fault-Tolerant%20File%20Processing&amp;summary=A%20majority%20of%20the%20big%20data%20setups%20still%20use%20files%20and%20streaming%20applications%20and%20platforms%20are%20a%20new%20concept.%20For%20a%20streaming%20platform%20to%20be%20widely%20usable%2C%20it%20should%20be%20able%20to%20handle%20files%20and%20process%20them%20in%20a%20performant%20way.%20Apache%20Apex%20provides%20out%20of%20the%20box%20support%20for%20handling%20files.%20This" target="_blank" data-placement="top" data-title="Linkedin" data-toggle="tooltip" title="" data-original-title="Linkedin"><span class="screen-reader-text">Linkedin</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-reddit fusion-icon-reddit" style="color:#bebdbd;" href="http://reddit.com/submit?url=https://www.datatorrent.com/blog/fault-tolerant-file-processing/&amp;title=Fault-Tolerant%20File%20Processing" target="_blank" data-placement="top" data-title="Reddit" data-toggle="tooltip" title="" data-original-title="Reddit"><span class="screen-reader-text">Reddit</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-tumblr fusion-icon-tumblr" style="color:#bebdbd;" href="http://www.tumblr.com/share/link?url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;name=Fault-Tolerant%20File%20Processing&amp;description=A%20majority%20of%20the%20big%20data%20setups%20still%20use%20files%20and%20streaming%20applications%20and%20platforms%20are%20a%20new%20concept.%20For%20a%20streaming%20platform%20to%20be%20widely%20usable%2C%20it%20should%20be%20able%20to%20handle%20files%20and%20process%20them%20in%20a%20performant%20way.%20Apache%20Apex%20provides%20out%20of%20the%20box%20support%20for%20handling%20files.%20This" target="_blank" data-placement="top" data-title="Tumblr" data-toggle="tooltip" title="" data-original-title="Tumblr"><span class="screen-reader-text">Tumblr</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-googleplus fusion-icon-googleplus" style="color:#bebdbd;" href="https://plus.google.com/share?url=https://www.datatorrent.com/blog/fault-tolerant-file-processing/" onclick="javascript:window.open(this.href,&#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;" target="_blank" data-placement="top" data-title="Google+" data-toggle="tooltip" title="" data-original-title="Google+"><span class="screen-reader-text">Google+</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-pinterest fusion-icon-pinterest" style="color:#bebdbd;" href="http://pinterest.com/pin/create/button/?url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;description=A%20majority%20of%20the%20big%20data%20setups%20still%20use%20files%20and%20streaming%20applications%20and%20platforms%20are%20a%20new%20concept.%20For%20a%20streaming%20platform%20to%20be%20widely%20usable%2C%20it%20should%20be%20able%20to%20handle%20files%20and%20process%20them%20in%20a%20performant%20way.%20Apache%20Apex%20provides%20out%20of%20the%20box%20support%20for%20handling%20files.%20This&amp;media=" target="_blank" data-placement="top" data-title="Pinterest" data-toggle="tooltip" title="" data-original-title="Pinterest"><span class="screen-reader-text">Pinterest</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-vk fusion-icon-vk" style="color:#bebdbd;" href="http://vkontakte.ru/share.php?url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;title=Fault-Tolerant%20File%20Processing&amp;description=A%20majority%20of%20the%20big%20data%20setups%20still%20use%20files%20and%20streaming%20applications%20and%20platforms%20are%20a%20new%20concept.%20For%20a%20streaming%20platform%20to%20be%20widely%20usable%2C%20it%20should%20be%20able%20to%20handle%20files%20and%20process%20them%20in%20a%20performant%20way.%20Apache%20Apex%20provides%20out%20of%20the%20box%20support%20for%20handling%20files.%20This" target="_blank" data-placement="top" data-title="Vk" data-toggle="tooltip" title="" data-original-title="Vk"><span class="screen-reader-text">Vk</span></a><a class="fusion-social-network-icon fusion-tooltip fusion-mail fusion-icon-mail fusion-last-social-icon" style="color:#bebdbd;" href="mailto:?subject=Fault-Tolerant%20File%20Processing&amp;amp;body=https://www.datatorrent.com/blog/fault-tolerant-file-processing/" target="_self" data-placement="top" data-title="Email" data-toggle="tooltip" title="" data-original-title="Email"><span class="screen-reader-text">Email</span></a><div class="fusion-clearfix"></div></div></div>			</div>
			                                                
                                                                                


	<div id="comments" class="comments-container">
		<div class="fusion-title fusion-title-size-three sep-double fusion-border-below-title" style="margin-top:0px;margin-bottom:31px;"><h3 class="title-heading-left" data-fontsize="20" data-lineheight="NaN">		One Comment		</h3><div class="title-sep-container"><div class="title-sep sep-double"></div></div></div>
							
		<ol class="comment-list commentlist">
							<li class="comment even thread-even depth-1" id="comment-122">
			<div class="the-comment">
				<div class="avatar"><img alt="" src="./Fault-Tolerant File Processing - DataTorrent_files/6683405c0eff4f99bf2e1e007c71a8c8" srcset="https://secure.gravatar.com/avatar/6683405c0eff4f99bf2e1e007c71a8c8?s=108&amp;d=mm&amp;r=g 2x" class="avatar avatar-54 photo" height="54" width="54"></div>
				<div class="comment-box">
					<div class="comment-author meta">
						<strong><a href="http://www.bestkatana.com/Clay-Tempered-Japanese-Samurai-Ninja-Katana-Wheel-Tsuba-Moroha-Zukuri-Blade-Sword-p437629.html" rel="external nofollow" class="url">Japanese Samurai Ninja Katana</a></strong>
						December 13, 2016 at 1:51 pm<a rel="nofollow" class="comment-reply-link" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/?replytocom=122#respond" onclick="return addComment.moveForm( &quot;comment-122&quot;, &quot;122&quot;, &quot;respond&quot;, &quot;4092&quot; )" aria-label="Reply to Japanese Samurai Ninja Katana"> - Reply</a>					</div>
					<div class="comment-text">
												<p>Very nicely made; it’s beautiful and feels very sturdy.</p>
					</div>
				</div>
			</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

								</div>



	
		<div id="respond" class="comment-respond">
		<div class="fusion-title title fusion-title-size-three sep-double fusion-border-below-title" style="margin-top:0px;margin-bottom:31px;"><h3 id="reply-title" class="comment-reply-title title-heading-left" data-fontsize="15" data-lineheight="18">Leave A Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#respond" style="display:none;">Cancel reply</a></small></h3><div class="title-sep-container"><div class="title-sep sep-double "></div></div></div>			<form action="https://www.datatorrent.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<div id="comment-textarea"><label class="screen-reader-text" for="comment">Comment</label><textarea name="comment" id="comment" cols="45" rows="8" aria-required="true" required="required" tabindex="0" class="textarea-comment" placeholder="Comment..." style="max-width: 715px;"></textarea></div><div id="comment-input"><input id="author" name="author" type="text" value="" placeholder="Name (required)" size="30" aria-required="true" required="required">
<input id="email" name="email" type="email" value="" placeholder="Email (required)" size="30" aria-describedby="email-notes" aria-required="true" required="required">
<input id="url" name="url" type="url" value="" placeholder="Website" size="30"></div>
<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="fusion-button fusion-button-default" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="4092" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>			</form>
			</div><!-- #respond -->
	
                                                            </div>
                                </div>
        <div id="sidebar" class="sidebar fusion-widget-area fusion-content-widget-area" style="float: right;">
			
			
			<div id="categories-2" class="widget widget_categories"><div class="heading"><h4 class="widget-title" data-fontsize="20" data-lineheight="24">Categories</h4></div>		<ul>
	<li class="cat-item cat-item-40"><a href="https://www.datatorrent.com/blog/category/business/">Business</a>
</li>
	<li class="cat-item cat-item-39"><a href="https://www.datatorrent.com/blog/category/technical/">Technical</a>
</li>
		</ul>
</div><div id="hybrid-archives-2" class="widget widget-archives widget_archive"><div class="heading"><h4 class="widget-title" data-fontsize="20" data-lineheight="24">Archives</h4></div><ul class="xoxo archives"><li><a href="https://www.datatorrent.com/blog/2018/">2018</a></li><li><a href="https://www.datatorrent.com/blog/2017/">2017</a></li><li><a href="https://www.datatorrent.com/blog/2016/">2016</a></li><li><a href="https://www.datatorrent.com/blog/2015/">2015</a></li><li><a href="https://www.datatorrent.com/blog/2014/">2014</a></li><li><a href="https://www.datatorrent.com/blog/2013/">2013</a></li></ul><!-- .xoxo .archives --></div>	</div>
    </div>
</div><!-- end dt list -->
 <div id="" class="cta-btn-link clearfix " style=" background-color:#eeeeee; background-image: url();"> 
   <div class="cta-btn-link__item"> 
     <h4 class="heading--4 cta-btn-link__heading--4" style="color:;" data-fontsize="20" data-lineheight="24">READY TO GET STARTED?</h4> 
   </div> 
  
    <div class="cta-btn-link__item"> 
     <a href="https://www.datatorrent.com/contact-us/" class="btn btn--green cta-btn-link__btn">CONTACT US</a> 
   </div> 
  
 </div> 
</div>  <!-- fusion-row -->




<!--
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
```````````````````````````````````````````````````````````````````````` FOOTER -->

<div class="footer clearfix">

    <!-- LEFT -->
    <div class="footer__left clearfix">
        <div class="clearfix">
            <ul class="footer__links clearfix copy--md">
                <li><a href="https://www.datatorrent.com/products-services/" class="footer__links-item">Products &amp; Services</a></li>
                <li><a href="https://www.datatorrent.com/appfactory/" class="footer__links-item">AppFactory</a></li>
                <li><a href="https://www.datatorrent.com/customers/" class="footer__links-item">Customers</a></li>
                <li><a href="https://www.datatorrent.com/company/about-us/" class="footer__links-item">Company</a></li>
                <li><a href="https://www.datatorrent.com/download/" class="footer__links-item">Download Now</a></li>
            </ul>
            <ul class="footer__links clearfix copy--md">
                <li><a href="https://www.datatorrent.com/resources/" class="footer__links-item">Resources</a></li>
                <li><a href="https://www.datatorrent.com/partners/" class="footer__links-item">Partners</a></li>
                <li><a href="https://www.datatorrent.com/support/" class="footer__links-item">Support</a></li>
                <li><a href="https://www.datatorrent.com/contact-us/" class="footer__links-item">Contact Us</a></li>
                <li><a href="https://www.datatorrent.com/site-map/" class="footer__links-item">Site Map</a></li>
            </ul>
        </div>
        <div class="footer__copyright copy--sm">
                        Copyright © 2018 DataTorrent<br>
            Apache, Hadoop, Apex, Yarn, HDFS and the Hadoop elephant and Apache project logos are either registered trademarks or trademarks of the Apache Software Foundation in the United States or other countries.<br><br>
            <a href="https://www.datatorrent.com/privacy-policy"> &nbsp;Privacy Policy</a>
        </div>
    </div><div class="footer__right">
        <!-- newsletters signup -->
        <div class="footer__newsletter-signup" style="display: none;">








            <label class="footer__newsletter-label">
                <fieldset class="footer__newsletter-fieldset">
                    <legend class="footer__newsletter-legend">Newsletter Sign Up</legend>


                    <script src="./Fault-Tolerant File Processing - DataTorrent_files/forms2.min.js"></script>
                    <form id="mktoForm_1496" novalidate="novalidate" class="mktoForm mktoHasWidth mktoLayoutLeft" style="font-family: Helvetica, Arial, sans-serif; font-size: 13px; color: rgb(51, 51, 51); width: 1121px;">
                    <style type="text/css">.mktoForm .mktoButtonWrap.mktoSimple .mktoButton {
color:#fff;
border:1px solid #75ae4c;
padding:0.4em 1em;
font-size:1em;
background-color:#99c47c;
background-image: -webkit-gradient(linear, left top, left bottom, from(#99c47c), to(#75ae4c));
background-image: -webkit-linear-gradient(top, #99c47c, #75ae4c);
background-image: -moz-linear-gradient(top, #99c47c, #75ae4c);
background-image: linear-gradient(to bottom, #99c47c, #75ae4c);
}
.mktoForm .mktoButtonWrap.mktoSimple .mktoButton:hover {
border:1px solid #447f19;
}
.mktoForm .mktoButtonWrap.mktoSimple .mktoButton:focus {
outline:none;
border:1px solid #447f19;
}
.mktoForm .mktoButtonWrap.mktoSimple .mktoButton:active{
background-color:#75ae4c;
background-image: -webkit-gradient(linear, left top, left bottom, from(#75ae4c), to(#99c47c));
background-image: -webkit-linear-gradient(top, #75ae4c, #99c47c);
background-image: -moz-linear-gradient(top, #75ae4c, #99c47c);
background-image: linear-gradient(to bottom, #75ae4c, #99c47c);
}
</style><div class="mktoFormRow"><div class="mktoFieldDescriptor mktoFormCol" style="margin-bottom: 10px;"><div class="mktoOffset" style="width: 10px;"></div><div class="mktoFieldWrap mktoRequiredField"><label for="Email" class="mktoLabel mktoHasWidth" style="width: 100px;"><div class="mktoAsterix">*</div>Email Address:</label><div class="mktoGutter mktoHasWidth" style="width: 10px;"></div><input id="Email" name="Email" placeholder="abc@abc.com" maxlength="255" type="email" class="mktoField mktoEmailField mktoHasWidth mktoRequired" style="width: 150px;"><div class="mktoClear"></div></div><div class="mktoClear"></div></div><div class="mktoClear"></div></div><div class="mktoButtonRow"><span class="mktoButtonWrap mktoSimple" style="margin-left: 120px;"><button type="submit" class="mktoButton">Submit</button></span></div><input type="hidden" name="formid" class="mktoField mktoFieldDescriptor" value="1496"><input type="hidden" name="munchkinId" class="mktoField mktoFieldDescriptor" value="661-RYF-836"></form>
                    <script>MktoForms2.loadForm("//app-ab06.marketo.com", 	"661-RYF-836", 1496);</script>


                    <!-- 		          <input class="footer__newsletter-field" placeholder="john@email.com" />
                                      <button class="footer__newsletter-submit"><i class="fa fa-plus" aria-hidden="true"></i></button> -->
                </fieldset>
            </label>
        </div>









        <!-- newsletters button -->
        <div class="footer__newsletter-btn">Newsletter Sign Up</div>

        <ul class="footer__social">
            <li><a href="https://www.facebook.com/DataTorrent/" class="footer__social-item" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
            <li><a href="https://twitter.com/datatorrent" class="footer__social-item" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
            <li><a href="https://www.linkedin.com/company/malhar-inc-" class="footer__social-item" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
            <li><a href="https://www.youtube.com/user/DataTorrent" class="footer__social-item" target="_blank"><i class="fa fa-youtube" aria-hidden="true"></i></a></li>

            <li><a href="http://www.meetup.com/Apache-Apex-Bay-Area/" class="footer__social-item" target="_blank">
                    <svg class="meetup-icon" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 5573.1 1990.2" style="enable-background:new 0 0 5573.1 1990.2;" xml:space="preserve">
		      	<path d="M3283.7,1072.6c-7.7,11.6-12.6,19.5-17.9,27.2c-49.8,71.4-105.8,136.6-182,181.7
		      		c-102.2,60.4-213,85.3-328.4,60.3c-59.2-12.9-114.4-46-170.2-72.5c-12.9-6.1-19.9-6.2-31.3,0.5c-47.9,28.2-94.4,59.9-145.1,81.8
		      		c-89.9,38.9-184.6,60.8-282.5,34.9c-61.4-16.2-114.4-50.8-162.4-92.4c-34-29.5-36.2-29.5-70.7-1.1c-62,51-133.6,83.9-208.5,111.1
		      		c-92.9,33.7-188.8,54.4-286.8,64.1c-119.6,11.8-230.5-8.5-311.4-106.8c-64.9-78.8-82.2-170.2-42.5-265.1
		      		c43.5-104,93.7-205.2,140.9-307.7c24.6-53.4,49.4-106.7,73.3-160.4c4.4-9.9,6.1-21.4,6.6-32.3c0.9-20,5-41.9-18.1-54
		      		c-23.6-12.3-51.5-10.1-68.9,11.9c-21.7,27.4-41,57.5-57.1,88.6c-53.6,102.8-105.4,206.6-157.7,310.1
		      		c-39.2,77.6-77.7,155.6-117.2,233c-37.5,73.4-107.9,101.4-184.3,72.8c-25.7-9.7-41.8-28.6-46.2-57.5c-6.1-40.9,7.3-77.6,21.8-114.2
		      		c31.7-80.2,63.8-160.2,95.5-240.4c17-43,34-86,49.9-129.4c11.2-30.3,14.5-62.5,1.5-92.3c-10.1-23-29.9-39.6-57.7-37.1
		      		c-30.4,2.7-54.3,18.6-65.8,46.8c-40.3,99.5-79,199.7-118.6,299.5c-47.4,119.4-94.1,239.2-143.5,357.8
		      		c-18.3,43.8-45.9,83.8-92.3,102.5c-23.5,9.5-50.1,15.4-75.4,15.8c-79,1-147.1-25.3-193.7-92.4C0,1264.3-9,1205,8.9,1142.2
		      		c16.6-58.1,33.1-116.2,50.5-174c16.5-54.8,33.9-109.4,51-164c15.9-50.9,30.8-102.2,48.1-152.6c34-99.3,61.4-201.5,115.2-292.6
		      		c36.8-62.3,96.5-96,164.9-116.9c71.5-21.8,132.5,5.6,193.5,36c23.2,11.5,46,23.8,69.8,33.8c33.2,13.9,63.4,5.1,90.2-16.7
		      		c21.9-17.8,44-35.7,64.2-55.4c50.5-49.3,159.5-58.4,212.8-1.1c12.3,13.2,26.8,24.3,40.3,36.3c27.9,24.6,39.4,27.2,71.7,8.9
		      		c76.8-43.3,156.3-37.3,234.4-9.6c45.3,16.1,72.5,54.7,89.8,100.3c25.5,67.2,14.8,132-10.7,195.2c-47,116.2-98.2,230.6-144,347.2
		      		c-27.2,69.2-50.1,140.3-69.7,212c-8,29.2-8,63.9-0.6,93.2c11.2,44.4,51.9,59,93.1,64.2c62.7,7.9,124.2-3.7,184.2-20.3
		      		c51.3-14.1,101.8-31.6,151.9-49.7c24.2-8.7,46.7-22.1,69.8-33.9c19.7-10,21.3-24.6,10.9-43c-21.2-37.5-43.6-74.5-62.3-113.3
		      		c-39.6-82-72.1-166.6-63.4-260c7.6-81.8,37.1-152.9,112.6-195.9c111.4-63.5,201.9-46,283.8,48.9c70.8,82.1,94.2,180.9,63.8,286.8
		      		c-17,59.2-41.4,116.4-64.6,173.7c-6.4,15.9-2.7,26,7.3,35.3c46.9,43.8,100.4,77.9,159.8,102c22.4,9.1,46.1,15.9,69.8,20.7
		      		c51,10.2,98.4-1.9,140.9-30.8c20.2-13.7,20.7-26.5,6.6-45.7c-97.8-133.4-136.5-281.9-107.1-445c11-61.1,39.3-118.8,104.8-136.4
		      		c40.5-10.9,86.3-10.4,128.5-5.1c68.5,8.7,130.5,36,172.6,95c50.5,70.8,63.4,148.2,41.6,232.8c-15.6,60.8-47.5,112.4-82.6,162.6
		      		c-13.9,19.9-14.4,38.2,4.5,51.6c29.2,20.5,58.8,43,91.8,54.9c71.6,25.8,146,23.5,218.1,0.3c79-25.4,134.5-77.8,166.1-155.5
		      		c37.8-93,38.3-190.3,36.3-288c-1.5-76.3-4.2-152.7-6.5-229.1c-0.8-27.3-5.2-28.9-31.2-23.6c-68.5,13.8-137.3,26.1-206.1,38.7
		      		c-21.7,3.9-43.5,6.6-65.2,10.5c-47.2,8.5-86.2-10.9-88.8-66.1c-2.7-55.7-10.8-111.1-16.5-166.6c-0.3-3.1-0.6-6.3-0.8-9.4
		      		c-3.2-65.4,12.6-100.9,91.1-98.1c81,3,162.1,5.6,243,9.9c39.8,2.1,53.8-8,56.4-47.5c2-30.7,2.9-61.4,4.8-92
		      		c2.9-46,13.4-56.9,60.1-55.1c27.9,1.1,56,6,83.3,12.1c38.5,8.6,58.6,35.7,61.3,74c2.2,31.3,1.3,62.9,0.8,94.4
		      		c-0.4,22.3,6.5,34.2,31.4,36.7c72,7.3,143.7,17.3,215.6,25.9c33.9,4,53,17.8,57.6,43c8,43.8-1.5,73.8-34.6,85.8
		      		c-46.3,16.7-94.1,29.5-141.9,41.3c-33.5,8.3-68.1,11.8-102.1,18.1c-22.8,4.2-35.2,16.2-35,41.8c0.9,126.8-2,253.7,1.7,380.4
		      		c1.9,66.5,11.9,133,40.2,195.1c22.9,50.3,61.9,70.1,116.3,61c79.7-13.4,152.8-41.4,216.4-91.8c35.3-28,58.6-62.2,60.3-109.5
		      		c3.2-86.6,7.5-173.1,12.5-259.5c1.5-24.9,4.3-50.8,12.6-74c4.6-12.9,21.6-30,33.4-30.3c65.1-2,130.7-2.6,195.5,3
		      		c40.8,3.5,68.8,41.7,66.6,84.8c-2.9,60.4-10.7,120.6-16.5,180.9c-7.1,74.4-13.7,148.9-21.6,223.2c-8,75.2,52.1,112.5,111.7,113.2
		      		c49.9,0.6,79.4-18,100.6-70.9c22-54.7,35-114,44.5-172.5c13.4-83,19.7-167.2,29.6-250.8c4-34.1,25.3-60.4,51.8-66.1
		      		c30.6-6.6,70.9,5.9,80.9,33.9c8.4,23.4,6.5,52,3.6,77.7c-10.8,95.2-26.4,190-35.4,285.4c-5.5,58.6,27.4,100.3,84.3,117.6
		      		c28.4,8.6,57.8,15.4,87.2,18.8c51.6,5.9,88.1-31.8,98.9-90.4c9.1-49.3,10.3-100.1,14.8-150.3c5.2-59.6,5.9-119.9,16.1-178.6
		      		c15-86.9,71.1-165.7,175.1-191c62.4-15.2,125.4-17,187.7-9.8c95,10.9,194.5,75.5,224.9,184.7c23.1,83,13.9,163.2-13.2,243
		      		c-31.5,92.5-88.9,164.6-169.2,219.5c-7.4,5.1-11.7,14.7-17.4,22.2c10.1,4.5,20.3,12.9,30.3,12.7c96-1.5,186.4-23.4,269.3-73.7
		      		c18.7-11.3,39.1-19.9,58.8-29.3c18.1-8.6,28.8,1.6,23.8,17.2c-8.4,26.2-18.5,53.9-35.3,75.1c-71,89.8-167.9,132.8-279.9,140.3
		      		c-47.5,3.2-95.7-3.2-143.6-5.8c-36.1-2-72.2-5.2-108.3-7.6c-18.3-1.2-28.9,6.5-33.5,25.5c-28.8,118.7-44,239.5-58.9,360.5
		      		c-9.4,76.2-23.6,152.2-41.9,226.8c-9.9,40.5-41.5,68.4-85.2,75.4c-26.1,4.2-45.5-7.1-54.3-31.5c-7.4-20.6-14.3-42.1-16.1-63.7
		      		c-8.6-106.3-5.1-212.3,9-318.1c7.2-53.8,11.9-107.9,18.1-161.9c4.3-37.5,10-74.9,13.5-112.5c2.8-30.4-4.1-37.5-33.2-43.3
		      		c-60.1-12-120.3-23.8-180.2-37c-40.7-9-72.4,5.4-99.9,33.4c-36.6,37.3-77.1,69.6-125.1,90.6c-58,25.3-119.5,20-179.1,10.5
		      		c-86.1-13.7-154.8-59-203.7-131.6c-15.2-22.5-26.2-47.9-38.1-72.5c-6.7-13.8-12.6-19.1-28.8-10.9c-57.2,29.1-114.2,59-173.2,84
		      		c-65.8,27.8-135.6,37.6-205.5,18.1c-68.1-19-120.4-62.9-163.8-117.7C3313.2,1110.5,3301.8,1095.7,3283.7,1072.6z M5246.2,800
		      		c-0.8-9.4-0.8-18.9-2.3-28.2c-8.7-53.7-62.6-77.7-106.1-45.4c-19.6,14.6-37.5,33.9-50.9,54.4c-44.8,68.6-65,147.2-85.2,225.4
		      		c-5.1,19.6-8.6,40.4-8.2,60.5c0.8,37.5,22.8,48.6,54.3,28.3c65.3-42.1,113.6-100.5,154.4-165.4C5227,890.2,5247.3,848.6,5246.2,800z
		      		 M2685.4,837.8c0.6-37.3-8.1-71.8-35.6-98.7c-15.2-14.9-34.3-21.3-56.1-14.5c-26.5,8.2-40.8,27.9-42.8,60.5
		      		c-3.9,63.2,23.3,117.5,51.2,171c14.4,27.5,28.1,26.7,46.6,1.2C2674.7,921.7,2684.8,881.3,2685.4,837.8z M2041.1,825.8
		      		c-6.9-22.9-11.5-46.8-21.3-68.3c-12.6-27.4-45.1-39.7-73.8-32.2c-30.4,8-42.4,22.5-39.3,59.9c2.8,32.6,10.3,65.1,18.9,96.7
		      		c6.4,23.3,16.2,46.1,27.7,67.3c15.6,28.5,31.9,28.8,47.2,1.2C2021.7,912.3,2038.1,872.3,2041.1,825.8z"></path>
		      	</svg>
                </a></li>

            <li><a href="https://github.com/apache/apex-core?" class="footer__social-item" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a></li>
        </ul>
    </div>
    <!-- BACK TO TOP -->
    <a href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#" class="btn btn--purple footer__back-to-top">Back to top</a>

    <!-- RIGHT -->
    
</div>


<!--
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
````````````````````````````````````````````````````````````````````````
```````````````````````````````````````````````````````````````````````` END FOOTER -->








<a class="fusion-one-page-text-link fusion-page-load-link"></a>

<!-- W3TC-include-js-head -->


<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.form.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var _wpcf7 = {"loaderUrl":"https:\/\/www.datatorrent.com\/wp-content\/plugins\/contact-form-7\/images\/ajax-loader.gif","recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"sending":"Sending ..."};
/* ]]> */
</script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/scripts.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/jquery.rwdImageMaps.min.js"></script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var toTopscreenReaderText = {"label":"Go to Top"};
var js_local_vars = {"admin_ajax":"https:\/\/www.datatorrent.com\/wp-admin\/admin-ajax.php","admin_ajax_nonce":"cacb004a5f","protocol":"1","theme_url":"https:\/\/www.datatorrent.com\/wp-content\/themes\/Avada","dropdown_goto":"Go to...","mobile_nav_cart":"Shopping Cart","page_smoothHeight":"false","flex_smoothHeight":"false","language_flag":"en","infinite_blog_finished_msg":"<em>All posts displayed.<\/em>","infinite_finished_msg":"<em>All items displayed.<\/em>","infinite_blog_text":"<em>Loading the next set of posts...<\/em>","portfolio_loading_text":"<em>Loading Portfolio Items...<\/em>","faqs_loading_text":"<em>Loading FAQ Items...<\/em>","order_actions":"Details","avada_rev_styles":"1","avada_styles_dropdowns":"1","blog_grid_column_spacing":"40","blog_pagination_type":"Pagination","carousel_speed":"2500","counter_box_speed":"1000","content_break_point":"800","disable_mobile_animate_css":"0","disable_mobile_image_hovers":"1","portfolio_pagination_type":"Pagination","form_bg_color":"#ffffff","header_transparency":"0","header_padding_bottom":"0px","header_padding_top":"0px","header_position":"Top","header_sticky":"1","header_sticky_tablet":"0","header_sticky_mobile":"0","header_sticky_type2_layout":"menu_only","sticky_header_shrinkage":"1","is_responsive":"1","is_ssl":"true","isotope_type":"masonry","layout_mode":"wide","lightbox_animation_speed":"Normal","lightbox_arrows":"1","lightbox_autoplay":"0","lightbox_behavior":"all","lightbox_desc":"1","lightbox_deeplinking":"1","lightbox_gallery":"1","lightbox_opacity":"0.9","lightbox_path":"vertical","lightbox_post_images":"1","lightbox_skin":"metro-white","lightbox_slideshow_speed":"5000","lightbox_social":"1","lightbox_title":"1","lightbox_video_height":"720","lightbox_video_width":"1280","logo_alignment":"Left","logo_margin_bottom":"31px","logo_margin_top":"31px","megamenu_max_width":"1100","mobile_menu_design":"modern","nav_height":"83","nav_highlight_border":"3","page_title_fading":"0","pagination_video_slide":"0","related_posts_speed":"2500","submenu_slideout":"1","side_header_break_point":"800","sidenav_behavior":"Hover","site_width":"1100px","slider_position":"below","slideshow_autoplay":"1","slideshow_speed":"7000","smooth_scrolling":"0","status_lightbox":"1","status_totop_mobile":"0","status_vimeo":"1","status_yt":"1","testimonials_speed":"4000","tfes_animation":"sides","tfes_autoplay":"1","tfes_interval":"3000","tfes_speed":"800","tfes_width":"150","title_style_type":"double","title_margin_top":"0px","title_margin_bottom":"31px","typography_responsive":"0","typography_sensitivity":"0.6","typography_factor":"1.5","woocommerce_shop_page_columns":"","woocommerce_checkout_error":"Not all fields have been filled in correctly.","side_header_width":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/main.min.js" async=""></script> 
<script type="text/javascript" src="./Fault-Tolerant File Processing - DataTorrent_files/wp-embed.min.js"></script>



<!--[if lte IE 8]>
<script type="text/javascript" src="https://www.datatorrent.com/wp-content/themes/Avada/assets/js/respond.js"></script>
<![endif]-->

<!-- Share This Links -->
<script type="text/javascript" id="st_insights_js" src="./Fault-Tolerant File Processing - DataTorrent_files/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "d8a07399-08cb-43f6-944a-e48d00603c51", doNotHash: false, doNotCopy: true, hashAddressBar: false});</script>
<!-- KickFire tracking code -->
<script type="text/javascript">
var DID=253644;
</script>
<script async="" src="./Fault-Tolerant File Processing - DataTorrent_files/live.js"></script>
<!-- LinkedIn Conversion tracking code -->
<script type="text/javascript"> _linkedin_data_partner_id = "97548"; </script>
<script type="text/javascript"> (function(){var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);})(); </script>
<noscript> &lt;img height="1" width="1" style="display:none;" alt="" src="https://dc.ads.linkedin.com/collect/?pid=97548&amp;fmt=gif" /&gt; </noscript>


<div class="full reveal modal without-overlay" id="nav__search" data-reveal="hby4jm-reveal" data-animation-in="fade-in" data-animation-out="fade-out" aria-labelledby="ns5rnz-reveal" role="dialog" aria-hidden="true" data-yeti-box="nav__search" data-resize="nav__search" data-events="resize" style="top: 0px; left: 0px; margin: 0px;">

                        <!-- click on page to close -->
                         <div style="width: 100%; height: 100%; top: 0; left: 0; position: absolute; z-index: 0;" data-close=""></div>

                        <!-- SEARCH -->
                        <form action="https://www.datatorrent.com/" method="get" style="position: relative; z-index: 9;">
                            <div class="nav__search-bar clearfix">
                                <input class="nav__search-input" name="s" id="s" placeholder="type to search...">
                                <button type="submit" class="nav__search-btn"><i class="fa fa-search" aria-hidden="true"></i></button>
                            </div>
                        </form>
                        <!-- CLOSE MODAL -->
                        <button class="close-button" data-close="" aria-label="Close modal" type="button">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div><div class="to-top-container"><a href="https://www.datatorrent.com/blog/fault-tolerant-file-processing/#" id="toTop" style="display: inline;"><span id="toTopHover"></span><span class="screen-reader-text">Go to Top</span></a></div><div id="mktoStyleLoaded" style="display: none; border-top-color: rgb(18, 52, 86);"></div><script src="https://px.ads.linkedin.com/collect/?time=1525325478918&amp;pid=97548&amp;url=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;pageUrl=https%3A%2F%2Fwww.datatorrent.com%2Fblog%2Ffault-tolerant-file-processing%2F&amp;ref=https%3A%2F%2Fwww.google.com%2F&amp;fmt=js&amp;s=1" type="text/javascript"></script><div id="stcpDiv" style="position: absolute; top: -1999px; left: -1988px;">ShareThis Copy and Paste</div><form novalidate="novalidate" class="mktoForm mktoHasWidth mktoLayoutLeft" style="font-family: Helvetica, Arial, sans-serif; font-size: 13px; color: rgb(51, 51, 51); visibility: hidden; position: absolute; top: -500px; left: -1000px; width: 1200px;"></form><iframe name="mktoFormsXDIframe0.4892967341678589" id="MktoForms2XDIframe" src="./Fault-Tolerant File Processing - DataTorrent_files/XDFrame.html" style="display: none;"></iframe><div id="stwrapper" class="stwrapper stwrapper4x" style="display: none;"><iframe allowtransparency="true" id="stLframe" class="stLframe" name="stLframe" frameborder="0" scrolling="no" src="./Fault-Tolerant File Processing - DataTorrent_files/index.html"></iframe></div><div id="stOverlay" onclick="javascript:stWidget.closeWidget();"></div></body></html>